FROM node:18-alpine

WORKDIR /app

# Create data directory structure
RUN mkdir -p /app/data

# Copy package files
COPY movie-club-web/package*.json ./
RUN npm ci --only=production

# Copy API server code
COPY movie-club-web/api-server.js .

EXPOSE 3001

# Make sure the API server can find the data directory
ENV NODE_PATH=/app

CMD ["node", "api-server.js"]
