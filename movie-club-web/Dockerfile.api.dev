FROM node:lts-alpine

WORKDIR /app

# Create data directory with proper permissions
RUN mkdir -p /app/data && chmod 777 /app/data

# Copy package files
COPY movie-club-web/package*.json ./
RUN npm ci
RUN npm install -g nodemon

# Don't copy source code - it will be mounted

EXPOSE 3001

# Default command with hot reloading
CMD ["nodemon", "api-server.js"]
